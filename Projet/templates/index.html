<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Groupie Tracker - Search</title>
</head>
<body>
<h1>Groupie Tracker</h1>
<input type="text" id="searchBar" list="suggestions" placeholder="Rechercher un artiste, un membre...">
<datalist id="suggestions"></datalist>
<script>
const input = document.getElementById('searchBar');
const list = document.getElementById('suggestions');

input.addEventListener('input', () => {
    const query = input.value;
    if (query.length < 1) {
        list.innerHTML = '';
        return;
    }
    fetch(`/api/artists?search=${query}`)
        .then(response => response.json())
        .then(artists => {
            list.innerHTML = '';
            artists.forEach(artist => {
                let optGroup = document.createElement('option');
                optGroup.value = artist.name;
                optGroup.label = "artist/band";
                list.appendChild(optGroup);
                artist.members.forEach(member => {
                    if (member.toLowerCase().includes(query.toLowerCase())) {
                        let optMem = document.createElement('option');
                        optMem.value = member;
                        optMem.label = "member";
                        list.appendChild(optMem);
                    }
                });
            });
        });
});
</script>
</body>
</html>
